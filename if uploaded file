st.write("**Click a query below to fill the next available force key:**")
max_rows = 30  # Show only the first 30 results for speed
show_df = filtered_df.head(max_rows)

for idx, row in show_df.iterrows():
    if st.button(row['query'], key=f"querybtn_{idx}"):
        fill_next_force_key(row['query'])
        st.rerun()
    # Optionally, show metrics below the button:
    st.caption(
        f"Avg Revenue: ${row['avg_revenue']} | "
        f"Total Revenue: ${row['total_revenue']} | "
        f"Avg RPC: ${row['avg_rpc']} | "
        f"Total RPC: ${row['total_rpc']} | "
        f"Avg Clicks: {row['avg_clicks']} | "
        f"Total Clicks: {row['total_clicks']}"
    )

if len(filtered_df) > max_rows:
    st.info(f"Showing only the first {max_rows} results. Use the search box to narrow down.")

st.write("**Current Force Keys:**")
for i, val in enumerate(st.session_state['force_keys']):
    st.write(f"Force Key {chr(65+i)}: {val}")
